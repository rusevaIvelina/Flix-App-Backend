<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>  /**
 * @file The models file implements schemas for documents held in the movies, genres and users collections in
 * the myFlix database. The schemas are used to create models, which in turn are used in http requests
 * to Api endpoints to create, read, update and delete documents from the database. Mongoose is 
 * connected to the database using the connect method in the index file.
 * @requires mongoose Connects the app to the database and implements data schemas using models.
 * @requires bcrypt Used to implement encryption on user passwords.
 */
 
  const mongoose = require ('mongoose');
    bcrypt = require('bcrypt');

   let movieSchema = mongoose.Schema({
       Title: {type: String, required: true},
       Description: {type: String, required: true},
       Genre: {
         Description: String
       },
       Director: {
          Name: String,
          Bio: String,
          BirthYear: Number
        },
        Year: Number,
        Rating: Number,
        Actors: [String],
        ImagePath: String,
        Featured: Boolean
     });

    let userSchema = mongoose.Schema({
        Username: {type: String, required: true},
        Password: {type: String, required: true},
        Email: {type: String, required: true},
        Birthday: Date,
        FavoriteMovies: [{type: mongoose.Schema.Types.ObjectId, ref: 'Movie'
        }]
     });

     /**
  * Static method to encrypt user passwords. Used when creating or updating users. 
  * Available to each instance of a user created.
  * @method hashPassword
  * @param {*} password - The user's password taken from the request body.
  * @returns {string} String containing the encrypted password.
  */

     userSchema.statics.hashPassword = (password) => {
       return bcrypt.hashSync(password, 10);
     };

     /**
  *  Custom method used to validate a user's password against the encrypted version in the database
  * when the user attempts to log in. Available to each instance of a user created.
  * @method validatePassword
  * @param {*} password - Password submitted by the user when logging in.
  * @returns {boolean} True if the password submitted when encrypted matches the encrypted password
  * taken from the database. 
  */

     userSchema.methods.validatePassword = function(password) {
       return bcrypt.compareSync(password, this.Password);
     };

    let Movie = mongoose.model ('Movie', movieSchema);
    let User = mongoose.model ('User', userSchema);

    module.exports.Movie = Movie;
    module.exports.User = User;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#hashPassword">hashPassword</a></li><li><a href="global.html#validatePassword">validatePassword</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Fri Apr 22 2022 11:53:20 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
